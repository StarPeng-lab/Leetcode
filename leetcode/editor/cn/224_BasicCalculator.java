package leetcode.editor.cn;
//basic-calculator
//å®ç°ä¸€ä¸ªåŸºæœ¬çš„è®¡ç®—å™¨æ¥è®¡ç®—ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²è¡¨è¾¾å¼ s çš„å€¼ã€‚
// ç¤ºä¾‹ 1ï¼š
//è¾“å…¥ï¼šs = "- 1 + 1"
//è¾“å‡ºï¼š0
//
// ç¤ºä¾‹ 2ï¼š
//è¾“å…¥ï¼šs = " 2-1 + 2 "
//è¾“å‡ºï¼š3
//
// ç¤ºä¾‹ 3ï¼š
//è¾“å…¥ï¼šs = "(1+(4+5+2)-3)+(6+8)"
//è¾“å‡ºï¼š23
//
// æç¤ºï¼š
// 1 <= s.length <= 3 * 105 
// s ç”±æ•°å­—ã€'+'ã€'-'ã€'('ã€')'ã€å’Œ ' ' ç»„æˆ 
// s è¡¨ç¤ºä¸€ä¸ªæœ‰æ•ˆçš„è¡¨è¾¾å¼ 
// 
// Related Topics æ ˆ æ•°å­¦ 
// ğŸ‘ 324 ğŸ‘ 0

public class BasicCalculator{
    public static void main(String[] args) {
        Solution solution = new BasicCalculator().new Solution();
        
    }

//leetcode submit region begin(Prohibit modification and deletion)
class Solution {
        /*
          æ–¹æ³•ä¸€ï¼šæ ˆ+æ­£åºéå†å­—ç¬¦ä¸²
          è§£å†³ - ç»“åˆå¾‹çš„é—®é¢˜çš„ä¸€ä¸ªåˆ†å‚ç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿å°† - è¿ç®—ç¬¦çœ‹ä½œå³ä¾§æ“ä½œæ•°çš„å¤§å°ã€‚ä¸€æ—¦æˆ‘ä»¬å°† - çœ‹ä½œæ“ä½œæ•°çš„å¤§å°ï¼Œåˆ™è¡¨è¾¾å¼å°†åªå‰©ä¸‹ä¸€ä¸ªæ“ä½œç¬¦ã€‚å°±æ˜¯ + è¿ç®—ç¬¦ï¼Œè€Œ + æ˜¯éµå¾ªç»“åˆå¾‹çš„ã€‚
          ä¾‹å¦‚ï¼ŒA-B-C ç­‰äº A + (-B) + (-C)ã€‚
          é‡å†™ä»¥åçš„è¡¨è¾¾å¼å°†éµå¾ªç»“åˆå¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»å·¦æˆ–ä»å³è®¡ç®—è¡¨è¾¾å¼éƒ½æ˜¯æ­£ç¡®çš„ã€‚
          æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ç»™å®šçš„è¡¨è¾¾å¼ä¼šå¾ˆå¤æ‚ï¼Œå³ä¼šæœ‰åµŒå¥—åœ¨å…¶ä»–è¡¨è¾¾å¼çš„è¡¨è¾¾å¼ã€‚
          å³ (A - (B - C))ï¼Œæˆ‘ä»¬éœ€è¦ B-C å¤–é¢çš„ - å·ä¸ B-C å…³è”èµ·æ¥ï¼Œè€Œä¸æ˜¯ä»…ä»…ä¸ B å…³è”èµ·æ¥ã€‚
          æˆ‘ä»¬å¯ä»¥é€šè¿‡éµå¾ªå‰é¢çš„åŸºæœ¬ç»ƒä¹ å¹¶å°†ç¬¦å·ä¸å…¶å³ä¾§çš„è¡¨è¾¾å¼å…³è”æ¥è§£å†³æ­¤é—®é¢˜ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å°†é‡‡ç”¨çš„æ–¹æ³•æœ‰ä¸€ä¸ªå°çš„è½¬æŠ˜ï¼Œå› ä¸ºæˆ‘ä»¬å°†åœ¨è¿è¡Œä¸­è¯„ä¼°å¤§å¤šæ•°è¡¨è¾¾å¼ã€‚è¿™å‡å°‘äº†æ¨é€å’Œå¼¹å‡ºæ“ä½œçš„æ•°é‡ã€‚
            ã€ç®—æ³•ã€‘ï¼š
            æ­£åºè¿­ä»£å­—ç¬¦ä¸²ã€‚
            æ“ä½œæ•°å¯ä»¥ç”±å¤šä¸ªå­—ç¬¦ç»„æˆï¼Œå­—ç¬¦ä¸² "123" è¡¨ç¤ºæ•°å­— 123ï¼Œå®ƒå¯ä»¥è¢«æ„é€ ä¸ºï¼š123 >> 120 + 3 >> 100 + 20 + 3ã€‚å¦‚æœæˆ‘ä»¬è¯»å–çš„å­—ç¬¦æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œåˆ™æˆ‘ä»¬è¦å°†å…ˆå‰å½¢æˆçš„æ“ä½œæ•°ä¹˜ä»¥ 10 å¹¶äºè¯»å–çš„æ•°å­—ç›¸åŠ ï¼Œå½¢æˆæ“ä½œæ•°ã€‚
            æ¯å½“æˆ‘ä»¬é‡åˆ° + æˆ– - è¿ç®—ç¬¦æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆå°†è¡¨è¾¾å¼æ±‚å€¼åˆ°å·¦è¾¹ï¼Œç„¶åå°†æ­£è´Ÿç¬¦å·ä¿å­˜åˆ°ä¸‹ä¸€æ¬¡æ±‚å€¼ã€‚
            å¦‚æœå­—ç¬¦æ˜¯å·¦æ‹¬å· (ï¼Œæˆ‘ä»¬å°†è¿„ä»Šä¸ºæ­¢è®¡ç®—çš„ç»“æœå’Œç¬¦å·æ·»åŠ åˆ°æ ˆä¸Šï¼Œç„¶åé‡æ–°å¼€å§‹è¿›è¡Œè®¡ç®—ï¼Œå°±åƒè®¡ç®—ä¸€ä¸ªæ–°çš„è¡¨è¾¾å¼ä¸€æ ·ã€‚
            å¦‚æœå­—ç¬¦æ˜¯å³æ‹¬å· )ï¼Œåˆ™é¦–å…ˆè®¡ç®—)å·¦ä¾§çš„è¡¨è¾¾å¼ã€‚åˆ™äº§ç”Ÿçš„ç»“æœå°±æ˜¯åˆšåˆšç»“æŸçš„å­è¡¨è¾¾å¼çš„ç»“æœã€‚
            å¦‚æœæ ˆé¡¶éƒ¨æœ‰ç¬¦å·ï¼Œåˆ™å°†æ­¤ç»“æœä¸ç¬¦å·ç›¸ä¹˜ï¼Œç»§ç»­å–å‡ºæ ˆé¡¶å…ƒç´ è¿›è¡Œè¿ç®—ã€‚
         */
    public int calculate(String s) {
        Stack<Integer> stack = new Stack<Integer>();
        int operand = 0;
        int result = 0;
        int sign = 1;

        for (int i = 0; i < s.length(); i++) {

            char ch = s.charAt(i);

            if (Character.isDigit(ch)) {
                operand = 10 * operand + (int) (ch - '0');
            } else if (ch == '+') {
                result += sign * operand;
                sign = 1;
                operand = 0;
            } else if (ch == '-') {
                result += sign * operand;
                sign = -1; //ä¿ç•™ç»™ä¸‹ä¸€æ¬¡éå†æ—¶ï¼Œè¿ç®—
                operand = 0;
            } else if (ch == '(') {
                stack.push(result); //å°†ä¸Šä¸€æ¬¡éå†çš„è¿ç®—ç»“æœï¼ˆå·¦ä¾§è¡¨è¾¾å¼çš„ç»“æœï¼‰å‹å…¥æ ˆ
                stack.push(sign); //å°†ä¸Šä¸€æ¬¡éå†çš„è¿ç®—ç»“æœçš„ç¬¦å·å‹å…¥æ ˆ
                sign = 1;
                result = 0;
            } else if (ch == ')') {
                result += sign * operand; //è®°å½•ä¸Šä¸€æ¬¡éå†çš„ç»“æœï¼Œç”¨åˆ°ä¸Šä¸€æ¬¡ä¿å­˜çš„è¿ç®—ç¬¦ ï¼ˆå½“å‰è¡¨è¾¾å¼ç»“æœï¼‰
                result *= stack.pop(); // å–å‡ºæ ˆä¸­çš„è¿ç®—ç¬¦
                result += stack.pop(); // å–å‡ºæ ˆä¸­çš„ç»“æœï¼Œä¸è¿™æ¬¡ç»“æœè¿›è¡Œè¿ç®—
                operand = 0;
            }
        }
        return result + (sign * operand);

    }


     /* æ–¹æ³•äºŒï¼šæ ˆ+é€†åºéå†å­—ç¬¦ä¸²
    //è¿™é‡Œåªéœ€å®ç°ç®€å•çš„åŠ å‡è¿ç®—ï¼Œè™½ç„¶åŠ å‡è¿ç®—æ˜¯åŒçº§çš„ï¼Œä½†æ˜¯å‡æ³•éœ€è¦æ³¨æ„é¡ºåº
    //è¿™é‡Œç”¨çš„æ–¹æ³•æ˜¯ï¼Œé€šè¿‡åè½¬å­—ç¬¦ä¸²ï¼Œç„¶åå†æŒ‰éœ€æ·»åŠ åˆ°æ ˆä¸­ï¼Œæˆ‘ä»¬å°†å­—ç¬¦ä¸²ä»å³åˆ°å·¦æ”¾å…¥æ ˆä¸­ï¼Œå¹¶ä»å·¦åˆ°å³æ­£ç¡®çš„è®¡ç®—è¡¨è¾¾å¼
    //å‡†å¤‡ä¸€ä¸ªæ ˆï¼Œã€ä»å³åˆ°å·¦ã€‘éå†å­—ç¬¦ä¸²sï¼Œ
        //é‡åˆ°' ' ï¼Œå°±å¿½ç•¥ï¼Œç»§ç»­forå¾ªç¯
        //é‡åˆ°æ•°å­—å°±å°†è¿ç»­çš„æ•°å­—æ‹¼æ¥ä¸ºçœŸæ­£çš„æ•°å­—ï¼Œå¦‚21ï¼Œè¿™æ˜¯ä¸¤ä¸ªå­—ç¬¦ï¼Œéœ€è¦æ‹¼æ¥ä¸ºæ•°å­—21ï¼Œå¹¶å…¥æ ˆ
        //é‡åˆ°'-','+',')'ï¼Œå°±ç›´æ¥å…¥æ ˆï¼›
        //é‡åˆ°'('ï¼Œå°±å¼€å§‹ä»æ ˆé¡¶å¼¹å‡ºå…ƒç´ ï¼Œå¦‚æœå¼¹å‡ºä¸ºå­—ç¬¦ï¼Œåˆ™ç»§ç»­å¼¹å‡ºæ–°çš„æ ˆé¡¶å…ƒç´ ä»£è¡¨æ•°å­—çš„æ­£è´Ÿï¼›å¦‚æœå¼¹å‡ºä¸ºæ•°å­—ï¼Œåˆ™ç›´æ¥ä½¿ç”¨
           //æ­¤æ—¶ä»æ ˆä¸­ç»§ç»­å¼¹å‡ºå…ƒç´ ï¼Œå³ç¬¦å·'-'æˆ–'+'ï¼›å†å¼¹ä¸€ä¸ªå…ƒç´ ï¼Œå³æ•°å­—ï¼›ä¹‹åå°±å¼€å§‹è¿ç®—ï¼Œå¹¶å°†è¿ç®—ç»“æœå‹å…¥æ ˆ
    //å­—ç¬¦ä¸²séå†å®Œæ¯•ï¼Œæ³¨æ„ï¼Œå¦‚æœsçš„ç¬¬ä¸€ä¸ªï¼ˆéå†çš„æœ€åä¸€ä¸ªï¼‰ä¸ºæ•°å­—ï¼Œè¦å‹å…¥æ ˆï¼›æ­¤æ—¶è‹¥æ ˆä¸­ä¸ä¸ºç©ºï¼Œåˆ™å°†æ ˆä¸­å…ƒç´ æŒ‰é¡ºåºå‡ºæ ˆå¹¶è¿ç®—
    //æ³¨æ„ï¼šå­—ç¬¦ä¸²så¯¹æ•°å­—çš„æ‹¼æ¥ï¼›
    //     æ ˆä¸­å­˜æ”¾çš„å…ƒç´ ç±»å‹å¤šæ ·ï¼Œå› æ­¤ç”¨Objectï¼Œæ³¨æ„ç±»å‹è½¬æ¢ï¼›æ³¨æ„-2+1å’Œ2+1ä¸­ï¼Œä»æ ˆé¡¶å¼¹å‡ºçš„å…ƒç´ ä¼šæœ‰å¤šç§ç±»å‹ï¼Œè¦åˆ¤æ–­æ˜¯java.lang.Characterè¿˜æ˜¯java.lang.Integer
    public int calculate(String s) {
        Stack<Object> stack = new Stack<>();
        int len = s.length();
        int n = 0;
        int operand = 0;
        int result = 0;
        for(int i = len-1 ; i >= 0 ; i--){
            char ch = s.charAt(i);

            if(Character.isDigit(ch)) { //åˆ¤æ–­chæ˜¯å¦ä¸ºæ•°å­—
                operand = (int)Math.pow(10,n) * (ch-'0') + operand; //è¿™é‡Œçš„ch-'0'è¦ç”¨æ‹¬å·åŒ…ç€ï¼Œå¦åˆ™å¯èƒ½å†…å­˜æº¢å‡º
                n++;
            }else if(ch != ' '){

                if(n != 0){ //è¯´æ˜ä¸æ˜¯æ•°å­—ï¼Œå¹¶ä¸”æ•°å­—å·²æ‹¼æ¥å®Œæˆï¼Œéœ€è¦å‹å…¥æ ˆ
                    stack.push(operand);
                    n = 0 ;
                    operand = 0 ;
                }

                if(ch == '('){ // ä»æ ˆä¸­å¼¹å‡ºå…ƒç´ ï¼Œè¿›è¡Œè¿ç®—ï¼Œè¿ç®—å®Œæ¯•åï¼Œå…ˆå¼¹å‡º'('ï¼Œå†å°†è¿ç®—ç»“æœå‹å…¥æ ˆ
                    result = getCount(stack);
                    stack.pop();
                    stack.push(result);
                }else{ //')'ã€'-'ã€'+'ï¼Œç›´æ¥å‹å…¥æ ˆ
                    stack.push(ch);
                }

            }
        }

        if(n != 0){ //éå†åˆ°sçš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œä¸ºæ•°å­—ï¼Œæ­¤æ—¶æœªè¿›å…¥forå¾ªç¯ä¸­çš„elseåˆ†æ”¯ï¼Œå› æ­¤è¿™ä¸ªæ•°å­—æ²¡æœ‰å…¥æ ˆ
            stack.push(operand);
        }

        return getCount(stack); //æœ€åç›´æ¥ä»æ ˆä¸­å¼¹å‡ºå…ƒç´ ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœ
    }
    public int getCount(Stack<Object> stack){
        int result = 0;

        if(!stack.isEmpty()){//æ ˆéç©ºï¼Œå…ˆå–å‡ºæ ˆé¡¶å…ƒç´ ï¼Œæ³¨æ„åˆ¤æ–­æ ˆé¡¶å…ƒç´ çš„ç±»å‹ï¼›æ³¨æ„æ ˆä¸­å¯èƒ½åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ­¤æ—¶è¿™ä¸ªå…ƒç´ å³ä¸ºè¿ç®—ç»“æœ
            String type = (stack.peek()).getClass().getName(); //stack.peek(),å¾—åˆ°çš„æ•°æ®ç±»å‹ä¸ºObject
            if(type.equals("java.lang.Integer")){ //2+1ï¼Œå–2
                result = (int)stack.pop(); //è™½ç„¶+=ä¼šè¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä½†stack.pop()æ˜¯Objectç±»å‹ï¼Œæ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ï¼Œè€ŒIntegeræ˜¯intçš„åŒ…è£…ç±»ï¼Œè¿™é‡Œä¸èƒ½å¯¹Objectç›´æ¥ç±»å‹è½¬æ¢ä¸ºint
                //result = ((Integer)stack.pop()).intValue();
            }else{ //-2+1ï¼Œå–-2
                char sign = (char)stack.pop();
                if(sign == '+'){
                    result += (int)stack.pop();
                }else if(sign == '-'){
                    result -= (int)stack.pop();
                }
            }
        }

        while(!stack.isEmpty() && (char)stack.peek() != ')'){//é‡åˆ° æ ˆä¸ºç©º æˆ– ')'ï¼Œå°±é€€å‡ºå¾ªç¯
            char sign = (char)stack.pop();
            if(sign == '+'){
                result += (int)stack.pop();
            }else if(sign == '-'){
                result -= (int)stack.pop();
            }
        }

        return result;
    }*/
}
//leetcode submit region end(Prohibit modification and deletion)

}